<?xml version="1.0"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd">

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
	  <!ENTITY rfc4345 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml/reference.RFC.4345.xml'>
	  <!ENTITY rfc4634 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml/reference.RFC.4634.xml'>
	  <!ENTITY sha2 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml2/reference.FIPS.180-2.2002.xml'>
	  ]>

<?rfc compact="yes"?>
<?rfc toc="yes"?>
<?rfc symrefs="yes"?>

<rfc category="info" ipr="trust200902"
     docName="draft-strombergson-chacha-test-vectors-00">

  <front>

    <title>
      Test Vectors for the Stream Cipher ChaCha
    </title>

    <author initials="J." surname="Strömbergson" fullname="Joachim Strömbergson">
      <organization>Secworks Sweden AB</organization>
      <address>
	<postal>
	  <street>Västra Hamngata 13A</street>
	  <city>Gothenburg</city>
	  <code>411 17</code>
	  <country>SE</country>
	</postal>
	<email>joachim@secworks.se</email>
	<uri>http://secworks.se/</uri>
      </address>
    </author>

    <date month="October" year="2013"/>

    <abstract>

      <t>This document contains test vectors for the stream cipher ChaCha 
      using 8, 12 and 20 rounds as well as 128 and 256 bit keys.</t>

    </abstract>

  </front>

  <middle>

    <section anchor="intro"
	     title="Introduction">

      <t>The <xref target="ChaCha">ChaCha</xref> algorithm is a
      fairly new stream cipher that is getting some attention. ChaCha has
      been proposed as a replacement for <xref target="RC4">RC4</xref>
      and ChaCha is also used in a few protocols.</t>

      <t>In order to efficiently implement the algorithm and ensure
      interoperability between different implementations, it is of great
      importance to be able to verify that a given implementation is
      functionally correct. Test vectors aids this verification by
      providing a known correct answer.</t>

      <t>Unfortunately, for ChaCha there are no test vectors
      published. This Internet Draft tries to rectify this by providing
      test vectors for ChaCha.</t>

    </section>


    <section anchor="test-vectors-description"
	     title="Description of the test Vectors">

      <t>The test vectors describes in this document is given as a
      number of test cases. For each test case there is a number of
      test vectors and known answers. The test vectors in a test case
      has been generated with support for:</t>
      
      <t>
        <list>
          <t>128 and 256 bit keys</t>
          <t>8, 12 and 20 rounds</t>
        </list>
      </t>

      <t>This means that for a given test case there are 6 different
      test vectors. Each of these test vectors contains the keystream
      for two 64 byte blocks.</t>
      
      <t>In order to further support implementation work, each test
      vector also contains the internal state of the cipher after the
      first and the second block respectively.</t>

      <t>The test vectors in this I-D has been generated by a simple
      generator based on the <xref target="chacha.c">chacha.c</xref> 
      reference model by Daniel J Bernstein. The generator has been
      verified to generate the same values as the reference model.
      reference model.</t>

      <t>All zero input data blocks, that is 64 bytes with the value of
      0x00 has been used during generation. Since ChaCha is a stream
      cipher and encryption, decryption is done by XOR-ing the data with
      the keystream. By using all zero data blocks we get the keystream
      itself.</t>

      <t>The test vector generator is available as a stand alone c
      program in the <xref
      target="chacha_testvectors">chacha_testvectors</xref> project 
      on Github.</t>

    </section>
      

    <section anchor="test-vectors-chacha"
	     title="Test vectors for ChaCha">

      <figure>
	<artwork>
TODO: Add test vectors. Loads of them.
	</artwork>
      </figure>

    </section>


    <section title="Security Considerations">

      <t>None.</t>
  
    </section>


    <section title="IANA Considerations">

      <t>None.</t>
  
    </section>


    <section title="Copying conditions">

      <t>This document is intended to be considered a Code Component,
	and is thus effectively available under the Simplified BSD
	license.</t>
  
    </section>

  </middle>

  <back>

    <references title="Normative References">

      <reference anchor="ChaCha">
	<front>
	  <title>ChaCha, a variant of Salsa20</title>
	  <author initials="DJB" surname="Bernstein"
		  fullname="Daniel J. Bernstein"/>
	</front>
      </reference>

      <reference anchor="RC4">
        <front>
          <title>Applied Cryptography, second edition,
            section 17.1, page 397</title>
          <author initials="B." surname="Schneier"
                  fullname="Bruce Schneier"/>
        </front>
      </reference>
    </references>

    <references title="Informative References">

     <reference anchor="chacha.c">
        <front>
          <title>chacha_testvectors</title>
          <author initials="DJB" surname="Bernstein" fullname="Daniel" />
        </front>
        <seriesInfo name="WWW"
                    value="http://cr.yp.to/chacha.html" />
      </reference>

     <reference anchor="chacha_testvectors">
        <front>
          <title>chacha_testvectors</title>
          <author initials="JS" surname="Strombergson" fullname="Joachim" />
        </front>
        <seriesInfo name="WWW"
                    value="https://github.com/secworks/chacha_testvectors/" />
      </reference>

    </references>

    </back>

</rfc>
